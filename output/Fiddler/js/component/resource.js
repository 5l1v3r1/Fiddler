var Fiddler_Resource=function(){"use strict";var e={},t=Fiddler.implement({},Fiddler.CustEvent),n=0;return Fiddler.mix(t,{clearResource:function(){e={}},add:function(t,r){var i=t.requestId;t[r+"Time"]=t.timeStamp;if(i in e)for(var s in t)e[i][s]=t[s];else e[i]=t;if(r=="onCompleted"){var o=e[i].type,u=e[i].method;o=="main_frame"&&u=="GET"?(n=i,e[i].parentRequestId=0):e[i].parentRequestId=n,e[i].size=0;var a=e[i].responseHeaders||[];a.some(function(t){if(t.name=="Content-Length")return e[i].size=t.value,!0});var f=Fiddler.getUrlDetail(t.url);Fiddler.mix(e[i],f,!0),this.fire("onCompleted",e[i])}},getItem:function(t){return e[t]||{}},getResoure:function(){return e},getContent:function(t){var n=when.defer(),r=e[t];return r.content?n.resolve(r.content):(Fiddler_File.getRemoteFile(t).then(function(r){e[t].content=r,n.resolve(r)}),n.promise)},getImgRect:function(e){var t=when.defer(),n=new Image;return n.onload=function(){t.resolve({width:this.width,height:this.height})},n.src=e,t.promise},getSize:function(t){var n=when.defer(),r=e[t];if(r.size)return n.resolve(r.size);if(r.content)return e[t].size=r.content.length,n.resolve(e[t].size);var i=this;return this.getContent(t).then(function(){return i.getSize(t)}).then(function(e){n.resolve(e)}),n.promise}}),t}()